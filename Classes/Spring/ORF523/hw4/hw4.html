<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2016-04-01 Fri 16:37 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Problem set 4, ORF523</title>
<meta name="generator" content="Org-mode" />
<meta name="author" content="Bachir El khadir" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="../../css/special-block.css" />
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
<script src="http://127.0.0.1:60000/autoreload.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Problem set 4, ORF523</h1>
<p>
+HTML<sub>HEAD</sub>: &lt;link href="<a href="http://thomasf.github.io/solarized-css/solarized-dark.min.css">http://thomasf.github.io/solarized-css/solarized-dark.min.css</a>" rel="stylesheet"&gt;&lt;/link&gt;
</p>
<div class="HTML">
<p>
<script>
AutoReload.Watch('localhost:60000');
</script>
</p>

</div>

<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1"><span class="section-number-2">1</span> Problem 1</h2>
<div class="outline-text-2" id="text-1">
<p>
Notations:
</p>
<ul class="org-ul">
<li>\(c^*\) the solution to the problem. It exists because every subset of \(\mathbb R\) has a supremum.</li>
<li>\(X = (x_1, x_2, x_3, x_4)\)</li>
</ul>

<p>
\(f(X) =
X^T\begin{pmatrix}
 1          & -\frac12 & a           & \frac1{10}  \\
 -\frac12   & 1        & b           & c           \\
 a          & b        & 1           & -\frac3{10} \\
 \frac1{10} & c        & -\frac3{10} & 1           \\
\end{pmatrix}
X+\begin{pmatrix}2\\-a\\0\\c\end{pmatrix}^TX
:= X^TSX + w^TX\)
</p>


<ul class="org-ul">
<li>If \(S\) is not nonnegative semi definite, there exist \(X\) such that \(X^TSX < 0\), and</li>
</ul>
<p>
\[f(\lambda X) = \lambda^2 X^TSX + \lambda w^TX \rightarrow_{\lambda \infty} -\infty\]
In order for the optimzation problem to be finite, we therefore need to have \(S \ge 0\).
</p>
<ul class="org-ul">
<li>If \(S\) positive definite, Let \(\lambda_{\min}\) be its smallest eign value. Then
\(f(X) \ge \lambda_{\min}  ||X||^2 - ||w|| ||X|| \ge \lambda_{\min} (||X|| - \frac1{2\lambda_{\min}}||w||)^2 + cte\) is bounded from below.</li>
</ul>

<p>
Let \(c^+\) be the solution to the following convex optimization problem:
\(\max_{a, b, c, S \ge 0} c\)
</p>

<div class="org-src-container">

<pre class="src src-matlab">n = 4
cvx_begin quiet
variable S(n,n) hermitian; 
variable a;
variable b;
variable c;

maximize(c);
S <span style="color: #84ffff;">==</span> hermitian_semidefinite( n );
<span style="color: #fff59d;">for</span> <span style="color: #ffcc80;">i</span> = <span style="color: #8bc34a;">1:4</span>
    S(<span style="color: #8bc34a;">i</span>, <span style="color: #8bc34a;">i</span>) <span style="color: #84ffff;">==</span> 1 
<span style="color: #fff59d;">end</span>

S(1, 2) <span style="color: #84ffff;">==</span> <span style="color: #84ffff;">-</span>1<span style="color: #84ffff;">/</span>2;
S(1, 3) <span style="color: #84ffff;">==</span> a;
S(1, 4) <span style="color: #84ffff;">==</span> 1<span style="color: #84ffff;">/</span>10;
S(2, 3) <span style="color: #84ffff;">==</span> b;
S(2, 4) <span style="color: #84ffff;">==</span> c;
S(3, 4) <span style="color: #84ffff;">==</span> <span style="color: #84ffff;">-</span>3<span style="color: #84ffff;">/</span>10;
cvx_end

<span style="color: #8bc34a;">ans</span> = [a b c]
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">-0.054543</td>
<td class="org-right">-0.22906</td>
<td class="org-right">0.81168</td>
</tr>
</tbody>
</table>



<p>
\(0.8116 > c^+\)
For all \(c > c^+\), the optimization problem is not finite, so \(c^* \le c^+\).
</p>

<p>
Let \(c^- = 0.8115\), we check with CVX that
\[S =\begin{pmatrix}
 1          & -\frac12 & a^-           & \frac1{10}  \\
 -\frac12   & 1        & b^-           & c^-           \\
 a^-          & b^-        & 1           & -\frac3{10} \\
 \frac1{10} & c^-        & -\frac3{10} & 1           \\
\end{pmatrix}
 > 0
\]
with \(a^- = -0.0682\), \(b^- = -0.2216\)
The problem for \(c^-\) is then finite, so \(c^- <= c\).
</p>

<p>
Conclusion: 
\[0.9116 \le c^* \le 0.9117\]
or
\[c^* \approx 0.911\]
</p>
</div>
</div>

<div id="outline-container-orgheadline2" class="outline-2">
<h2 id="orgheadline2"><span class="section-number-2">2</span> Alternative way</h2>
<div class="outline-text-2" id="text-2">
<p>
\[ S = \begin{pmatrix}
 1          & -\frac12 & a           & \frac1{10}  \\
 -\frac12   & 1        & b           & c           \\
 a          & b        & 1           & -\frac3{10} \\
 \frac1{10} & c        & -\frac3{10} & 1           \\
\end{pmatrix}\]
</p>

<p>
With a change of variable \(x_3 \leftrightarrow x_4\), we can rewrite \(S\):
\[Q = \begin{pmatrix}
 1          & -\frac12 &  \frac1{10}  & a\\
 -\frac12   & 1        &  c           & b\\
 \frac1{10} & c & 1 & -\frac3{10}\\
 a          & b        &  -\frac3{10} & 1
\end{pmatrix}\]
</p>

<p>
Note that \(Q \ge 0 \iff S \ge 0\), and \(Q > 0 \iff S > 0\).
</p>

<p>
In order of \(Q\) to be positive semi-definite, the following submatrix has to have a non-negative determinant:
</p>

<p>
\[  Q_1 = \begin{pmatrix}
 1          & -\frac12 &             \frac1{10}  \\
 -\frac12   & 1        &             c           \\
 \frac1{10} & c        &  1           \\
\end{pmatrix}\]
</p>

<div class="org-src-container">

<pre class="src src-matlab">syms a b c;
S=[1,<span style="color: #84ffff;">-</span>1<span style="color: #84ffff;">/</span>2,a,1<span style="color: #84ffff;">/</span>10;<span style="color: #84ffff;">-</span>1<span style="color: #84ffff;">/</span>2,1,b,c;a,b,1,<span style="color: #84ffff;">-</span>3<span style="color: #84ffff;">/</span>10;1<span style="color: #84ffff;">/</span>10,c,<span style="color: #84ffff;">-</span>3<span style="color: #84ffff;">/</span>10,1];
Q_1 = [1 <span style="color: #84ffff;">-</span>1<span style="color: #84ffff;">/</span>2 1<span style="color: #84ffff;">/</span>10; <span style="color: #84ffff;">-</span>1<span style="color: #84ffff;">/</span>2 1 c; 1<span style="color: #84ffff;">/</span>10 c 1]
</pre>
</div>


<p>
\(det(Q_1) = - c^2 - \frac1{10}c + \frac{37}{50}\)
</p>

<p>
It has two roots \(r_1 = \frac{-1 - 3\sqrt{33}}{10}, r_2 = \frac{-1 + 3\sqrt{33}}{10}\). Since the leadin coefficient is negative, the polynomial is non-negative iff \(c \in [r_1, r_2]\).
</p>

<p>
Let's now check that for \(c \in ]r_1, r_2[\), there exist \(a, b\) that make \(Q > 0\).
Indeed, by using Sylvester criterion:
</p>

<ul class="org-ul">
<li>\(1 > 0\)</li>
<li>\[\det\begin{pmatrix}1&-\frac12\\-\frac12&1\end{pmatrix} = 1 - \frac14 > 0\]</li>
<li>\(det(Q_1) > 0\)</li>
</ul>

<p>
It remains to show that there exist to show that there exist \(a, b\) that make the following determinant positive:
</p>
\begin{align*}P(a, b) &:= \begin{vmatrix}
 1          & -\frac12 &  \frac1{10}  & a\\
 -\frac12   & 1        &  c           & b\\
 \frac1{10} & c & 1 & -\frac3{10}\\
 a          & b        &  -\frac3{10} & 1
\end{vmatrix}
\\&=
a^2c^2 - (3b)/100 - c/10 - ab - (3ac)/10 - (3bc)/5 - a^2 - (99b^2)/100 - c^2 - (3a)/50 - (abc)/5 + 269/400
\\&=
(c^2 - 1) a^2  -\frac{99}{100} b^2 - (\frac3{10}c + \frac3{50})a - (\frac3{100} + \frac35 c)b - (\frac{c}5+1) ab  - c^2 - c/10  + \frac{269}{400}
\\&=
-\begin{pmatrix}a\\b\end{pmatrix}^T
\underbrace{\begin{pmatrix}1-c^2&\frac{c}{10}+\frac12\\\frac{c}{10}+\frac12&\frac{99}{100}\end{pmatrix}\begin{pmatrix}a\\b\end{pmatrix}}_R
- \underbrace{\begin{pmatrix}\frac3{10}c + \frac3{50}\\ - (\frac3{100} + \frac35 c)\end{pmatrix}}_{v}\begin{pmatrix}a\\b\end{pmatrix}
\underbrace{- c^2 - c/10  + \frac{269}{400}}_{\alpha}
\\&=
\begin{pmatrix}a\\b\end{pmatrix}^TR\begin{pmatrix}a\\b\end{pmatrix}
-v\begin{pmatrix}a\\b\end{pmatrix}
+ \alpha
\end{align*}

<p>
\(R\) is symmetric, we can decompose it as \(R = UU^T\) 
with
</p>

<p>
\[U =\begin{pmatrix}
 \sqrt{1 - c^2}  &  \frac{c + 5}{10\sqrt{1 - c^2}}\\
               0 & \sqrt{\frac{50c^2 + 5c - 37}{50(c^2 - 1)}}
\end{pmatrix}
\]
</p>

<p>
Let's do the change of variable \((x, y) = U(a, b)\):
\[P(a, b) = \begin{pmatrix}x\\y\end{pmatrix}^T\begin{pmatrix}x\\y\end{pmatrix} -(vU^{-1})\begin{pmatrix}x\\y\end{pmatrix}+ \alpha\]
</p>

<div class="org-src-container">

<pre class="src src-matlab">R = [(1<span style="color: #84ffff;">-</span>c<span style="color: #84ffff;">^</span>2), (c<span style="color: #84ffff;">/</span>10 <span style="color: #84ffff;">+</span> 1<span style="color: #84ffff;">/</span>2); (c<span style="color: #84ffff;">/</span>10<span style="color: #84ffff;">+</span>1<span style="color: #84ffff;">/</span>2), 99<span style="color: #84ffff;">/</span>100];
U = chol(R, <span style="color: #9ccc65;">'real'</span>);
v = <span style="color: #84ffff;">-</span>[]
<span style="color: #8bc34a;">ans</span> = 0
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline3" class="outline-2">
<h2 id="orgheadline3"><span class="section-number-2">3</span> Problem 2</h2>
<div class="outline-text-2" id="text-3">
<ol class="org-ol">
<li>Let  \(\Vert A\Vert _{\text{dual}} = \max_{\Vert X\Vert _{op} \le 1} \langle Y, X\rangle\) and let's prove that \(\Vert A\Vert _* = \Vert A\Vert _{\text{dual}}\)</li>
</ol>
<div class="lemma">
<p>
If  \(A = U\Lambda V^T\) be the SVD decomposition of \(A\), then \(\nucnorm{A} = \tr(\Lambda)\)
</p>

</div>


<ul class="org-ul">
<li>Let \(A = U\Lambda V^T\) be the SVD decomposition of \(A\), then \(\langle A, UV^T\rangle  = \tr(V \Lambda U^TUV^T) = \tr(V\Lambda V^T) = \tr(\Lambda) = \Vert A \Vert _*\). Note that \(\opnorm{UV^T} = 1\) because \(UV^T\) is orthogonal. We have just proved that  \(\Vert A\Vert _* \le \Vert A\Vert _{\text{dual}}\)</li>
</ul>


<ul class="org-ul">
<li>Let \(X\) be a matrix st \(\opnorm{X} \le 1\), \(\langle A, X\rangle  = \tr(A^TX) = \tr(V \Lambda U^TX) = \tr(\Lambda U^TXV) = \sum \Lambda_{ii} (U^TXV)_{ii}  = \sum \Lambda_{ii} \underbrace{u_i^TXv_i}_{\le \Vert X\Vert _{op}} \le  \Vert X\Vert _{op} \Vert \Lambda\Vert _* \le \Vert A\Vert _*\). so  \(\Vert A\Vert _* \ge \Vert A\Vert _{\text{dual}}\)</li>

<li>As a conclusion \(\Vert A\Vert _* = \max_{\Vert X\Vert _{op} \le 1} \langle Y, X\rangle\), and \(\opnorm{.}\) is the dual of \(\nucnorm{.}\)</li>
</ul>


<p>
Let's now prove that the nuclear norm is indeed a norm:
</p>
<ul class="org-ul">
<li>If \(\nucnorm{A} = 0\), then \(\forall i \le m \wedge n \; \sigma_i(A) = 0\), If \(U\Lambda V\) the SVD of A, then \(\Lambda = 0\), and therefore \(A = 0\).</li>
<li>If \(\alpha > 0\), \(\alpha A = U (\alpha \Lambda) V^T\), and therefore \(\nucnorm{\alpha A} = \tr(\alpha \Lambda) = \alpha \tr(\Lambda) = \alpha \nucnorm{A}\)</li>
<li>If \(\alpha < 0\), \(\alpha A  = (-U) (-\alpha \Lambda) V^T\), we conclude in the same way as before.</li>
<li>\(\nucnorm{A + B} = \max_{\opnorm{X} \le 1} <A + B, X> = \max_{\opnorm{X} \le 1} <A, X> + <B, X> \le  \max_{\opnorm{X} \le 1} <A, X> +  \max_{\opnorm{X} \le 1} <B, X>\) (Where we have used the fact that \(\sup(S_1+S_2) \le \sup S_1 + \sup S_2\) for any two sets \(S_1, S_2\)), so \(\nucnorm{A+B} \le \nucnorm{A} + \nucnorm{B}\)</li>
</ul>


<ol class="org-ol">
<li></li>
</ol>

<p>
Let's first find unit sphere
</p>

<p>
\(A = \begin{pmatrix}x&y\\y&z\end{pmatrix}\), Let \(\lambda_1, \lambda_2\) be its eigen values.
</p>

\begin{align*}
\nucnorm{A} = 1
& \iff |\lambda_1| + |\lambda_2| = 1
\\ &\iff \lambda_1^2 + \lambda_2^2 + 2|\lambda_1\lambda_2| = 1
\\ &\iff (\lambda_1 + \lambda_2)^2 + - 2\lambda_1 \lambda_2 + 2 |\lambda_1\lambda_2| = 1
\\ &\iff \tr(A)^2  + 2 (|det(A)| -det(A)) = 1
\\ &\iff (\tr(A)^2  = 1 \text{ and } \det(A) \ge 0) \text{ or }  (\tr(A)^2 - 4 det(A) = 1 \text{ and } \det(A) \le 0)
\\ &\iff ((x+z)^2  = 1 \text{ and } xz \ge y^2) \text{ or }  ((x+z)^2 - 4 (xz-y^2) = 1 \text{ and } xz \le y^2)
\\ &\iff ((x+z)^2  = 1 \text{ and } xz \ge y^2) \text{ or }  ((x-z)^2 + 4 y^2 = 1 \text{ and } xz \le y^2)
\end{align*}


<p>
Let's do the linear change of variable
</p>

\begin{align*}
u &= \frac{x + z}{\sqrt 2}\\
v &= \sqrt2 y\\
w &= \frac{x - z}{\sqrt 2}\\
\end{align*}

<p>
Which can also be written in matrix form as:
</p>

<p>
\[\begin{pmatrix}u\\w\\v\end{pmatrix}=\underbrace{\begin{pmatrix}
cos(-\frac{\pi}4)&-sin(-\frac{\pi}4)&0\\
sin(-\frac{\pi}4)&cos(-\frac{\pi}4)&0\\
0&0&\frac1{\sqrt2}\\
\end{pmatrix}}_{R}
\begin{pmatrix}x\\z\\y\end{pmatrix}\]
The linear transformation \(R\) is then a rotation of \(-\frac{\pi}4\) in the \((X, Z)\) plane, and a scaling of \(\frac1{\sqrt2}\) along the \(Y\) axis.
</p>

<p>
To find the shape of the unit cylinder, we work in the \((u, v, w)\) space, and then we apply to inverse transformation of \(R\).
</p>


<p>
Then \(2xz = u^2 - w^2\), and
</p>
\begin{align*}
\nucnorm{A} = 1
&\iff (2 u^2 = 1 \text{ and } u^2 - w^2 \ge v^2) \text{ or }  (2 w^2 + 2 v^2 = 1 \text{ and } u^2 - w^2 \le v^2)
\\&\iff (u^2 = \frac12 \text{ and } u^2 \ge v^2 + w^2) \text{ or }  (w^2 + v^2 = \frac12 \text{ and } u^2 \le v^2 + w^2)
\\&\iff (u = \pm \frac12 \text{ and } \frac12 \ge v^2 + w^2) \text{ or }  (w^2 + v^2 = \frac12 \text{ and }-\frac12 \le u \le \frac12)
\end{align*}

<p>
\(\{u = \pm \frac12 \text{ and } \frac12 \ge v^2 + w^2\}\) is two centered disks of radius \(\frac1{\sqrt2}\) in the plane \(u=\pm \frac12\) .
\(\{w^2 + v^2 = \frac12 \text{ and }-\frac12 \le u \le \frac12\}\) is the lateral surface of the cylinder of radius \(\frac1{\sqrt 2}\) and axis \(u\)
</p>

<p>
<b>Conclusion:</b> In \((u, v, w)\) space, the unit sphere \(S(0, 1)\) is the basis and lateral surface of the cylinder with radius \(u\), radius \(\frac1{\sqrt2}\), and height \(1\).
</p>


<div class="lemma">
<p>
The unit ball \(B(0, 1)\) is the convex hull of the unit sphere \(S(0, 1)\).
</p>

</div>
<p>
\(B(0, 1)\) is convex containing \(S(0, 1)\). If \(x, y \in S(0, 1)\), and \(\alpha \in (0, 1)\), then \(|\alpha x + (1-\alpha)y|_* \le \alpha |x|_* + (1-\alpha) |y|_* \le 1\) because of the triangular inequality. 
</p>

<p>
\(B(0, 1)\) is then a cylinder.
</p>


<div class="org-src-container">

<pre class="src src-python"><span style="color: #fff59d;">import</span> matplotlib
<span style="color: #fff59d;">import</span> matplotlib.pyplot <span style="color: #fff59d;">as</span> plt
<span style="color: #fff59d;">from</span> mpl_toolkits.mplot3d <span style="color: #fff59d;">import</span> Axes3D
<span style="color: #fff59d;">import</span> np

<span style="color: #ffcc80;">num_points</span> = 30

<span style="color: #b0bec5;"># </span><span style="color: #b0bec5;">Construct cylinder</span>
<span style="color: #b0bec5;"># </span><span style="color: #b0bec5;">base</span>
<span style="color: #ffcc80;">x</span>=np.linspace(-1,1,num_points)
<span style="color: #ffcc80;">z</span>=np.linspace(-1,1,num_points)
<span style="color: #ffcc80;">X</span>, <span style="color: #ffcc80;">Z</span>=np.meshgrid(x,z)
<span style="color: #ffcc80;">Y</span>=np.sqrt(1-X**2)

<span style="color: #ffcc80;">P</span> = <span style="color: #ff8A65;">map</span>(<span style="color: #fff59d;">lambda</span> u: u.ravel(), [X, Y, Z])
<span style="color: #ffcc80;">P</span>[0] = np.concatenate((P[0], X.ravel()))
<span style="color: #ffcc80;">P</span>[1] = np.concatenate((P[1], (-Y.ravel())))
<span style="color: #ffcc80;">P</span>[2] = np.concatenate((P[2], Z.ravel()))

<span style="color: #b0bec5;"># </span><span style="color: #b0bec5;">lateral surface</span>
<span style="color: #ffcc80;">t</span>=np.linspace(0,1,num_points)
<span style="color: #ffcc80;">theta</span>=np.linspace(0, 2*np.pi,num_points)
<span style="color: #ffcc80;">T</span>, <span style="color: #ffcc80;">Theta</span> = np.meshgrid(t, theta)

<span style="color: #ffcc80;">X</span> = np.cos(Theta)*T
<span style="color: #ffcc80;">Y</span> = np.sin(Theta)*T
<span style="color: #ffcc80;">Z</span> = X*0 + 1
<span style="color: #ffcc80;">P</span>[0] = np.concatenate((P[0], X.ravel()))
<span style="color: #ffcc80;">P</span>[1] = np.concatenate((P[1], Y.ravel()))
<span style="color: #ffcc80;">P</span>[2] = np.concatenate((P[2], Z.ravel()))

<span style="color: #ffcc80;">P</span>[0] = np.concatenate((P[0], X.ravel()))
<span style="color: #ffcc80;">P</span>[1] = np.concatenate((P[1], Y.ravel()))
<span style="color: #ffcc80;">P</span>[2] = np.concatenate((P[2], -Z.ravel()))

<span style="color: #b0bec5;"># </span><span style="color: #b0bec5;">Inverse tranformation</span>
<span style="color: #ffcc80;">R</span> = np.array([[1, 0, 1], [0, 2, 0], [1,0,-1]]) / np.sqrt(2)
<span style="color: #ffcc80;">P</span> = np.array(P)
<span style="color: #ffcc80;">P</span> = np.dot(np.linalg.inv(R), P)

<span style="color: #b0bec5;"># </span><span style="color: #b0bec5;">Plot</span>
<span style="color: #ffcc80;">fig</span> = plt.figure()
<span style="color: #ffcc80;">ax</span> = fig.add_subplot(111, projection=<span style="color: #9ccc65;">'3d'</span>)
ax.scatter(*P)
plt.xlabel(<span style="color: #9ccc65;">'x'</span>)
plt.ylabel(<span style="color: #9ccc65;">'y'</span>)
plt.zlabel(<span style="color: #9ccc65;">'z'</span>)
plt.show()
fig.savefig(<span style="color: #9ccc65;">'cylinder.png'</span>)
</pre>
</div>


<div class="figure">
<p><img src="./cylinder.png" alt="cylinder.png" class="center" />
</p>
<p><span class="figure-number">Figure 1:</span> Shape of the unit nuclear ball</p>
</div>


<p>
<b>3.</b>
</p>
<div class="lemma">
<p>
For \(Y \in \mathbb R^{n\times m}\)
\[||Y||_{op} \le 1 \iff \begin{pmatrix}I_n&Y\\Y^T&I_m\end{pmatrix} \ge 0\]
</p>

</div>
<p>
Proof: \(||Y||_{op} \le 1 \iff \forall x \in \mathbb{R^m} \le 1 x^TY^TYx \le x^TI_mx \iff Y^TI_nY \le I_m\) We conclude by Schur lemma.
</p>


<p>
Back to the problem, we can write the nuclear norm as a solution to an SDP:
</p>
\begin{align*}
.||X||_* = \max_{||Y||_{op} \le 1} <X, Y>
&= \max_{\begin{pmatrix}I_n&Y\\Y^T&I_m\end{pmatrix} \ge 0} <X, Y>
\\&= \max_{\underbrace{\begin{pmatrix}I_n&Y\\Y^T&I_m\end{pmatrix}}_Z \ge 0} <X, Y>
\\&= \frac12 \max_{Z \ge 0, Z \in C}  < \underbrace{\begin{pmatrix}0&X\\X^T&0\end{pmatrix}}_{X'}, Z>
\end{align*}

<p>
Where
</p>
<ul class="org-ul">
<li>\(C = \{Z \in \mathbb R^{(n+m)\times(n+m)} : <E_{ij},Z> = 1_{i = j} \text{ for } (i, j) \in \mathcal I \}\) is a set defined by affine inequalities</li>
<li>\(E_{ij}\) is the \((n+m)\times(n+m)\) matrix with 0 every where except on the entries \((i,j)\) and \((j, i)\) where it is equal to 1.</li>
<li>\(\mathcal I = \{ (i, j) \in [1, n+m]^2, ((i \vee j) \le n) \text{ or } (n < (i \wedge j))\}\)</li>
</ul>

<p>
The feasible set \(\{Z \ge 0, Z \in C\} \equiv \{Y : ||Y||_{op} \le 1\}\) is the unit ball of a norm, so it is strictly feasible.
</p>

<p>
The dual of this SDP can then be written as:
</p>

<p>
\(\min_{\mu \in \mathbb R^{\mathcal I}, \sum_{(i,j) \in I} \mu_{ij} E_{ij} \ge X'} <\mu, b>\)
</p>

<p>
Where \(b_{ij} = 1_{ij}\)
</p>

<p>
The feasible set of this program can be written as:
</p>

<p>
\[\{ (\mu_1, \mu_2) \in \mathbb R^{n\times n} \times \mathbb R^{m \times m} \begin{pmatrix}\mu_1&X\\X^T&\mu_2\end{pmatrix} \ge 0\}\]
</p>

<p>
This set also strictly feasible, indeed, since adding \(t\) times the identity matrix shift all the eigen values, for \(t \in \mathbb R\) large enough, we have that:
</p>

<p>
\(\begin{pmatrix}tI_n&X\\X^T&tI_m\end{pmatrix} > 0\)
</p>


<p>
This proves that the primal and dual are equal.
</p>

<p>
Now, we can rewrite the originial problem \(\min_{\mathcal A(X) = c} |X|_*\) where \(\mathcal A\) any linear functional as:
\(\min_{\mathcal A(X) = c} |X|_* = \min_{\mathcal A(X) = c} \max_{|Y|_{op} \le 1} <X, Y> =  \min_{X, \mu, \mathcal A(X) = c, \sum \mu_i A_i \ge X'} \mu^T b\)
Where \(b, X'\) are the same as defined above. This is obviously an SDP.
</p>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4"><span class="section-number-2">4</span> Problem 3</h2>
<div class="outline-text-2" id="text-4">
<p>
<b>1.</b>
</p>

<p>
Let's first show the following:
</p>
<div class="lemma">
<p>
a Matrix \(D\) is a distance matrix of somes points \(x_1, \ldots, x_n\) iff there exist \(X \ge 0, X \in \mathbb R^{m \times m}\) such that \(D_{ij} = X_{ii} + X_{jj} - 2X_{ij}\) 
</p>

</div>
<p>
Indeed, if \(D\) is the distance matrix of \(x_1, \ldots, x_n\), let \(X = (<x_i, x_j>)_{ij}\). Then:
</p>
<ul class="org-ul">
<li>\(D_{ij} = ||x_i - x_j||^2 = <x_i, x_i> + <x_j, x_j> - 2 <x_i, x_j> = X_{ii} + X_{jj} - 2 X_{ij}\).</li>
<li>\(X\) is symmetric because \(<.,.>\) is symmetric.</li>
<li><p>
Let \(y \in \mathbb R^n\)  \(y^TXy = \sum_{ij} <x_i, x_j> y_iy_j = ||\sum y_i x_i||_2^2 \ge 0\), so \(X \ge 0\)
</p>

<p>
For the converse, let \(X\) a psd such that \(D_{ij} = X_ii + X_jj - 2X_{ij}\). By Cholesky decomposition, let \(M = \begin{pmatrix}m_1^T\\\vdots\\m_n^T\end{pmatrix} \in \mathbb R^{n \times n}\) s.t \(X = MM^T\), eg \(X_{ij} =m_i^Tm_j\), so that \(D_{ij} = ||m_i - m_j||^2\)
</p>

<p>
Using this Lemma, to solve the problem we have the check only if \(D\) can be written as  \(D_{ij} = X_{ii} + X_{jj} - 2X_{ij}\) for some matrix \(X \ge 0\).
e.g. check if the following SDP is feasible \[\{X \ge 0; D_{ij} = X_{ii} + X_{jj} - 2X_{ij}\}\]. 
</p></li>
</ul>


<p>
<b>2.</b>
Take
\[D = \begin{pmatrix}
   0 & 1 & 1 & 1\\
   1 & 0 & 1 & 1\\
   1 & 1 & 0 & 2\\
   1 & 1 & 2 & 0\\
  \end{pmatrix}
  \]
It trivially verifies the triangular inequality.
</p>

<p>
Suppose it is a distance matrix, then by the lemma, there exist 4 points \(x_1, x_2, x_3, x_4\) in \(\mathbb R^4\)
such that \(||x_i - x_j|| = D_{ij}, i,j=1,\ldots,4\)
</p>

<ul class="org-ul">
<li>\(x_2, x_3, x_4 \in B(x_1, 1)\)</li>
<li>\(|x_4-x_3| = 2\), so \([x_4, x_3]\) is a diameter in \(B(x_1, 1)\), so \(x_1 \in \frac{x_3 + x_4}2\)</li>
<li>\(|x_2 - x_4| + |x_2 - x_3| = 1 + 1 = |x_4 - x_3|\), so \(x_2 \in [x_3, x_4]\), so \(x_2 = \frac{x_4 - x_3}2 = x_1\)</li>
<li><p>
But \(|x_2 - x_1| = 1 \ne 0\), contradiction
</p>

<p>
Concolusion: \(D\) is not a distance matrix.
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline5" class="outline-2">
<h2 id="orgheadline5"><span class="section-number-2">5</span> Problem 4</h2>
<div class="outline-text-2" id="text-5">
<p>
<b>1.</b>
</p>

<p>
\(A_1 = \begin{pmatrix} 0 & 1 \\ 0 & 0 \end{pmatrix}\)
</p>

<p>
\(A_2 = \begin{pmatrix} 0 & 0 \\ 1 & 0 \end{pmatrix}\)
</p>

<p>
\(A_2 A_1 = \begin{pmatrix}0& 0\\0&1\end{pmatrix}\)
</p>


<p>
\(A_1, A_2\) and \(A_2A_1\) are triangular, so the eigen values are all in the diagonal,  e.g \(\rho(A_1) = \rho(A_2) = 0\), but , \(\rho(A_2A_1) = 1\).
</p>

<p>
<b>2.</b>
</p>

<p>
The following program:
</p>
<div class="org-src-container">

<pre class="src src-matlab">A1 = [<span style="color: #84ffff;">-</span>1 <span style="color: #84ffff;">-</span>1; <span style="color: #84ffff;">-</span>4 0] <span style="color: #84ffff;">/</span> 4;
A2 = [3 3; <span style="color: #84ffff;">-</span>2 1] <span style="color: #84ffff;">/</span> 4;

cvx_begin sdp
variable P(2, 2)
minimize(P(2, 1))
P <span style="color: #84ffff;">&gt;=</span> 1
A1 <span style="color: #84ffff;">*</span> P <span style="color: #84ffff;">*</span> A1' <span style="color: #84ffff;">&lt;=</span> P
A2 <span style="color: #84ffff;">*</span> P <span style="color: #84ffff;">*</span> A2' <span style="color: #84ffff;">&lt;=</span> P
cvx_end

<span style="color: #8bc34a;">ans</span>=P
</pre>
</div>

<p>
proves that there exist \(P \ge 0\)  such that:
</p>

<p>
\(A_1' P A_1 \le P, A_2' P A_2 \le P\)
</p>


<div class="lemma">
<p>
Let \(A, B \ge 0\), If \(A \ge 0\), then \(B'AB \ge 0\)
</p>

</div>


<div class="proof">
<p>
Indeed, for \(x \in \mathbb R^n\), \(x'B'ABx = (Bx)' A (Bx) \ge 0\)
</p>

</div>

<p>
Let \(\Sigma\) be a product of term of the form \(A_1\) or \(A_2\)
</p>

<p>
Let's prove by induction on the size on the number of terms \(\Sigma\), that \(\Sigma' P \Sigma \le P\).
</p>

<p>
Indeed, let \(\Sigma\) be of size \(n+1\), without loss of generality \(\Sigma = \Sigma_1 A_1\), with \(\Sigma_1\) of size \(n\).
</p>

<p>
Then \(\Sigma' P \Sigma = A_1' \underbrace{\Sigma_1' P \Sigma_1}_{\le P} A_1 \le A_1' P A_1 \le A_1\).
</p>

<p>
By lyapounouv theorem, \(\Sigma\) is then stable, or equivalenty \(\{A_1, A_2\}\) is stable.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: <span class="timestamp-wrapper"><span class="timestamp">&lt;2016-03-11 Fri&gt;</span></span></p>
<p class="author">Author: Bachir El khadir</p>
<p class="date">Created: 2016-04-01 Fri 16:37</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
