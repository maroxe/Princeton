<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2016-03-22 Tue 21:11 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Problem set 4, ORF525</title>
<meta name="generator" content="Org-mode" />
<meta name="author" content="Bachir El khadir" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="../../css/special-block.css" />
<link href="http://thomasf.github.io/solarized-css/solarized-dark.min.css" rel="stylesheet"></link>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
<script src="http://127.0.0.1:60000/autoreload.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Problem set 4, ORF525</h1>
<div class="HTML">
<p>
<script>
AutoReload.Watch('localhost:60000');
</script>
</p>

</div>


<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1"><span class="section-number-2">1</span> Q1</h2>
<div class="outline-text-2" id="text-1">
<p>
1.1)
a)
Some helper functions
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock1"><span style="color: #8bc34a;">library</span>(png)
<span style="color: #8bc34a;">library</span>(kernlab)
<span style="color: #8bc34a;">library</span>(ggplot2)
<span style="color: #8bc34a;">library</span>(glmnet)
<span style="color: #8bc34a;">source</span>(<span style="color: #9ccc65;">"functions.R"</span>)

<span style="color: #84ffff;">crop</span> <span style="color: #8bc34a;">&lt;-</span> <span style="color: #fff59d;">function</span>(img) crop.r(img, 160, 96)
<span style="color: #84ffff;">take.grad</span> <span style="color: #8bc34a;">&lt;-</span> <span style="color: #fff59d;">function</span>(img) grad(img, 128, 64, F)
<span style="color: #84ffff;">take.hog</span> <span style="color: #8bc34a;">&lt;-</span> <span style="color: #fff59d;">function</span>(grad.img) hog(grad.img$xgrad, grad.img$ygrad, 4, 4, 6)

<span style="color: #84ffff;">plt.grad</span> <span style="color: #8bc34a;">&lt;-</span> <span style="color: #fff59d;">function</span>(grad.img, h=128, w=64, ...) {
    plot(c(),c(), asp=1, xlim=c(0,70), ylim=c(0,130), xlab=<span style="color: #9ccc65;">"X"</span>, ylab=<span style="color: #9ccc65;">"Y"</span>, ...)
    <span style="color: #fff59d;">for</span> (i <span style="color: #fff59d;">in</span> 1:h){
        <span style="color: #fff59d;">for</span> (j <span style="color: #fff59d;">in</span> 1:w){
            arrows(x0=j, y0=h+1-i, x1=j+grad.img$xgrad[i,j]*5, y1=h-i+1+grad.img$ygrad[i,j]*5, length=0.01)
        }
    }
}

<span style="color: #84ffff;">plt.gray</span> <span style="color: #8bc34a;">&lt;-</span> <span style="color: #fff59d;">function</span>(img.gray, ...) image(t(img.gray)[, nrow(img.gray):1], col  = gray((0:32)/32), ...)


<span style="color: #84ffff;">load.from.directory</span> <span style="color: #8bc34a;">&lt;-</span> <span style="color: #fff59d;">function</span>(dir) {
    images = list()
    img <span style="color: #8bc34a;">&lt;-</span> sample(list.files(dir), size=1) 
    <span style="color: #fff59d;">return</span>(readPNG(file.path(dir, img)))
}
</pre>
</div>


<p>
Load images, convert to gray, crop if necessary, and then calculate the gradient / hod
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock2">image.pos <span style="color: #8bc34a;">&lt;-</span> load.from.directory(<span style="color: #9ccc65;">"pngdata/pos"</span>)
image.neg.uncropped <span style="color: #8bc34a;">&lt;-</span> load.from.directory(<span style="color: #9ccc65;">"pngdata/neg"</span>)
image.neg.gray.uncropped <span style="color: #8bc34a;">&lt;-</span> rgb2gray(image.neg.uncropped)
image.pos.gray <span style="color: #8bc34a;">&lt;-</span> rgb2gray(image.pos)
image.neg.gray <span style="color: #8bc34a;">&lt;-</span> crop(image.neg.gray.uncropped)
grad.pos <span style="color: #8bc34a;">&lt;-</span> take.grad(image.pos.gray)
grad.neg <span style="color: #8bc34a;">&lt;-</span> take.grad(image.neg.gray)
hog.pos <span style="color: #8bc34a;">&lt;-</span> take.hog(grad.pos)
hog.neg <span style="color: #8bc34a;">&lt;-</span> take.hog(grad.neg)
0
</pre>
</div>



<p>
And then plot
</p>
<p>
<a href="./pos.eps">./pos.eps</a>
</p>

<p>
<a href="./neg.eps">./neg.eps</a>
</p>



<p>
b)
Prepare the dataset
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock3"><span style="color: #b0bec5;"># </span><span style="color: #b0bec5;">load all images from directory</span>
<span style="color: #84ffff;">load.all.directory</span> <span style="color: #8bc34a;">&lt;-</span> <span style="color: #fff59d;">function</span>(dir) {
    images = list()
    <span style="color: #fff59d;">for</span>(img <span style="color: #fff59d;">in</span> list.files(dir)) {
        images[[img]] <span style="color: #8bc34a;">&lt;-</span> readPNG(file.path(dir, img))
    }
    <span style="color: #fff59d;">return</span>(images)
}

<span style="color: #b0bec5;"># </span><span style="color: #b0bec5;">extract features</span>
<span style="color: #84ffff;">feature.pos.img</span> <span style="color: #8bc34a;">&lt;-</span> <span style="color: #fff59d;">function</span>(img) c(1, take.hog(take.grad(rgb2gray(img))))
<span style="color: #84ffff;">feature.neg.img</span> <span style="color: #8bc34a;">&lt;-</span> <span style="color: #fff59d;">function</span>(img) c(0, take.hog(take.grad(crop(rgb2gray(img)))))

pos.images <span style="color: #8bc34a;">&lt;-</span> load.all.directory(<span style="color: #9ccc65;">"pngdata/pos"</span>)
neg.images <span style="color: #8bc34a;">&lt;-</span> load.all.directory(<span style="color: #9ccc65;">"pngdata/neg"</span>)
data <span style="color: #8bc34a;">&lt;-</span> c(
    unname(lapply(pos.images, feature.pos.img)),
    unname(lapply(neg.images, feature.neg.img))
)
data <span style="color: #8bc34a;">&lt;-</span> sapply(data, identity)

<span style="color: #b0bec5;"># </span><span style="color: #b0bec5;">construct data frame</span>
df <span style="color: #8bc34a;">&lt;-</span> data.frame(t(data))
colnames(df) <span style="color: #8bc34a;">&lt;-</span> c(<span style="color: #9ccc65;">"label"</span>, paste(<span style="color: #9ccc65;">"F"</span>,1:96, sep=<span style="color: #9ccc65;">'_'</span>))
df[1:3, 1:5]
</pre>
</div>



<p>
1.2)
</p>
<ol class="org-ol">
<li><p>
     \(\log(C)\) take values in a uniform grid of 100 points of \([-4, 2]\). For each value, we evaluate the cross validation error of the corresponding SVM and we plot the result.
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock4"><span style="color: #b0bec5;"># </span><span style="color: #b0bec5;">SVM                                        </span>
<span style="color: #84ffff;">logspace</span> <span style="color: #8bc34a;">&lt;-</span> <span style="color: #fff59d;">function</span>(s, e, n=100) 10^((1:n-1) / n * (e-s) + s)
C <span style="color: #8bc34a;">&lt;-</span> logspace(-4, 2, 10)
formula <span style="color: #8bc34a;">&lt;-</span> as.formula(paste(<span style="color: #9ccc65;">"label"</span>, paste(colnames(df)[-1], collapse=<span style="color: #9ccc65;">'+'</span>), sep=<span style="color: #9ccc65;">'~'</span>))
cross.error <span style="color: #8bc34a;">&lt;-</span> sapply(C, <span style="color: #fff59d;">function</span>(c) {ksvm(formula, df, cross=10, C=c)@cross})
C.best <span style="color: #8bc34a;">&lt;-</span> C[which.min(cross.error)]
C.best
</pre>
</div></li>
</ol>


<div class="figure">
<p><img src="svmcrosserror.png" alt="svmcrosserror.png" />
</p>
</div>



<ol class="org-ol">
<li>Now we use glmnet</li>
</ol>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock5">x <span style="color: #8bc34a;">&lt;-</span> t(data[2:nrow(data),])
y <span style="color: #8bc34a;">&lt;-</span> data[1, ]
logit.model <span style="color: #8bc34a;">&lt;-</span> glmnet(x, y, family=<span style="color: #9ccc65;">"binomial"</span>)
cvlogit.model <span style="color: #8bc34a;">&lt;-</span> cv.glmnet(x, y, family = <span style="color: #9ccc65;">"binomial"</span>, type.measure=<span style="color: #9ccc65;">"class"</span>)
</pre>
</div>




<div class="figure">
<p><img src="logitcrosserror.png" alt="logitcrosserror.png" />
</p>
</div>



<ol class="org-ol">
<li><p>
Compare
</p>

<div class="org">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" class="center">
<caption class="t-above"><span class="table-number">Table 1:</span> Cross validation classification error</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">SVM</td>
<td class="org-right">Logit 1st Lambda</td>
<td class="org-right">Logit min Lambda</td>
</tr>

<tr>
<td class="org-right">0.066</td>
<td class="org-right">0.103</td>
<td class="org-right">0.099</td>
</tr>
</tbody>
</table>

</div></li>
</ol>
</div>
</div>



<div id="outline-container-orgheadline2" class="outline-2">
<h2 id="orgheadline2"><span class="section-number-2">2</span> <span class="todo TODO">TODO</span> Q2</h2>
<div class="outline-text-2" id="text-2">
<p>
(a)
</p>

<p>
\(p(x) = p(x | Y = 1) p(Y = 1) +  p(x | Y = -1) p(Y = -1) = \frac13 \frac{1_{[-5, 10]}}{15} +  \frac23 \frac{1_{[-10, 5]}}{15}\)
</p>

<p>
\[p(y | x) = \frac{ p(x | y)}{p(x)} p(y) \equiv
\left\{\begin{array}{cc}
p(Y = 1) p(x | Y=1)  & \text{if } y = 1\\
p(Y = -1) p(x | Y=-1)  & \text{if } y = -1
\end{array}\right.
\]
</p>

<p>
The bayes classifier \(B(x) := \arg \max_{y \in \{0, 1\}} p(y | x)\)
\[B(x) = 1 \iff p(Y = 1)p(x|Y=1) \ge p(Y = -1)p(x|Y=-1) \iff  1_{[-5, 10]}(x) \ge 2 \times 1_{[-10, 5]}(x) \iff x \in (5, 10)\]
</p>

<p>
\[B(x) =
\left\{\begin{array}{cc}
1 & \text{if } x \in (5, 10)\\
-1 & \text{o.w}
\end{array}
\right.
\]
</p>

<p>
Bayres Risk \(R(B) = E[1_{B(X) \ne Y}] = P(Y = 1, X \in (-5, 5)) = P(X \in (-5, 5) | Y = 1)P(Y = 1) = \frac23 \times \frac13 = \frac29\)
</p>

<p>
(b)
\(R(h) = E[1_{h(X) \ne Y}] = P(sign(\alpha  + \beta X^2) < 0 | Y = 1)P(Y = 1) +  P(sign(\alpha  + \beta X^2) > 0 | Y -= 1)p(Y = -1) = \frac13 \left( P_{U \sim \mathcal U([-5, 10])}(sign(\alpha  + \beta U^2) < 0) + 2 P_{U \sim \mathcal U([-10, 5])}(sign(\alpha  + \beta U^2) > 0)\right)\)
</p>

<p>
If \(\alpha\) and \(\beta\) have the same signs, then \(\alpha + \beta X^2\) keeps a constant sign.
If not, then \(\alpha + \beta X^2\) has two roots \(\pm \sqrt{\frac{-\alpha}{\beta}}\), and has the sign of \(\alpha\) only between them. Let \(r = \sqrt{\frac{-\alpha}{\beta}}\)
Cases:
</p>
<ul class="org-ul">
<li>\(\alpha = 0, \beta = 0\) ??</li>
<li>\(\alpha \ge 0, \beta > 0\) or \(\alpha > 0, \beta \ge 0\), \(sign(\alpha + \beta X^2)  = 1\), \(R(h) = \frac13\)</li>
<li>\(\alpha \le 0, \beta < 0\) or \(\alpha < 0, \beta \le 0\), \(sign(\alpha + \beta X^2)  = -1\), \(R(h) = \frac23\)</li>
<li>\(\alpha < 0, \beta > 0\), \(sign(\alpha + \beta X^2) = 2 \times 1_{x \in (\pm \sqrt{\frac{-\alpha}{\beta}})} - 1\):
\(R(h) = \frac13 \frac{1}{15} \left( (10 \wedge r)+ (5 \wedge r) + 2( (5-r)^+ + (10-r)^+)   \right)\)
\[R(h) = \frac1{45}\left\{\begin{array}{ccc}15 &\text{if} & r \ge 10\\ r +5 + 2(10-r)=25-r &\text{if} & 5 < r < 10\\  2r+2(5-r + 10-r) = 30 - 2r &\text{if} & r \le 5 \end{array} \right.\]</li>

<li>\(\alpha > 0, \beta < 0\), can be deduced from the last question because \(sign(\alpha + \beta x^2) = - sign(-\alpha - \beta x^2)\)</li>
</ul>

<div class="org">

<div class="figure">
<p><img src="img/bayeserror1.png" alt="bayeserror1.png" class="center" />
</p>
<p><span class="figure-number">Figure 3:</span> Bayess Error</p>
</div>

</div>

<p>
One possible solution is \(\alpha = -1\), \(\beta = 0\), and the risk is \(R(h) = \frac13\)
</p>


<p>
(c)
</p>

\begin{align*}
R_{\Phi}(\beta)
&= E[(1 - Y\beta X)^+] = E[(1 - \beta U_1)^+] p(Y = 1) +  E[(1 + \beta U_2)^+] p(Y = -1)
\\&= \frac13 \int_0^1 (1 - \beta (15 u - 5))^+ + 2 (1 + \beta (15 u - 10))^+ du
\\&= \frac13 \int_0^1 (1 - 15 \beta (u - \frac13))^+ + 2 (1 + 15 \beta ( u - \frac23))^+ du
\end{align*}

<div class="org">

<div class="figure">
<p><img src="img/hingerisk.png" alt="hingerisk.png" class="center" />
</p>
<p><span class="figure-number">Figure 4:</span> Hinge Error</p>
</div>

</div>
</div>
</div>


<div id="outline-container-orgheadline3" class="outline-2">
<h2 id="orgheadline3"><span class="section-number-2">3</span> Q3</h2>
<div class="outline-text-2" id="text-3">
<p>
3.1.
\(f(x) = \frac1{\sqrt{2\pi|\Sigma|}} e^{\frac12 x'\Sigma^{-1}x}\)
</p>

<p>
\[p(y | x) \equiv p(Y = y) p(X = x | Y = x) = \left\{\begin{array}{cc}p f(x-\mu_1) &  \text{if } y = 1\\(1-p) f(x-\mu2) & \text{ if } y = -1\end{array}\right.\]
</p>

<p>
bayes estimator:
</p>

\begin{align*}
B(x) = 1 \iff \frac{f(x - \mu_1)}{f(x - \mu_2)} \ge \frac{1-p}p 
& \iff (x-\mu_1)'\Sigma^{-1}(x-\mu_1) - (x-\mu_2)'\Sigma^{-1}(x-\mu_2) \ge \log\frac{1-p}p \\
& \iff x \underbrace{2\Sigma^{-1}(\mu_2 - \mu_1)}_{\omega} \ge \underbrace{\log\frac{1-p}p + \mu_2'\Sigma^{-1}\mu_2 - \mu_1'\Sigma^{-1}\mu_1}_{-b} \\
& \iff sign(x.w + b) = 1
\end{align*}

<p>
MLE (see ORF524):
</p>
<ul class="org-ul">
<li>\(\hat p = \frac1n \sum_{i=1}^n 1_{Y_i = 1}\)</li>
<li>\(\hat \mu_j = \frac1{n_j} \sum_{(Y_i, X_i) \in D_j} X_i\) where \(j = 1,2\)</li>
<li>\begin{align*}
\hat \Sigma &= \frac1n \left[ \sum_{(Y_i, X_i) \in D_1} (x_i-\hat \mu_1)(x_i-\hat \mu_1)^T +  \sum_{(Y_i, X_i) \in D_2} (x_i-\hat \mu_2)(x_i-\hat \mu_2)^T \right]
\\&= \frac1n \left[ \sum_{(Y_i, X_i) \in D_1} x_ix_i^T- \hat \mu_1\hat \mu_1^T +  \sum_{(Y_i, X_i) \in D_2} x_ix_i^T- \hat \mu_2\hat \mu_2^T  \right]
\\&= \frac1n  \sum_i x_ix_i^T - \frac{n_1}n \hat \mu_1\hat \mu_1^T - \frac{n_2}n \hat \mu_2\hat \mu_2^T
\end{align*}</li>
</ul>


<p>
Let \(\hat \omega := 2 \hat \Sigma^{-1}(\hat \mu_2 - \hat \mu_1), \hat b = \log\frac{1-\hat p}{\hat p} + \hat \mu_2'\hat \Sigma^{-1}\hat \mu_2 - \hat \mu_1'\hat \Sigma^{-1}\hat \mu_1\), then by plugging the precedent values we can see that the classifier can be expressed as \(sign(\hat \omega . x+ \hat b)\).
</p>

<p>
3.2
The function of \((\beta_0, \beta)\) is convex. First order condition gives:
</p>
<ul class="org-ul">
<li>With respect to \(\beta_0\): \(\sum_i (Y_i - \beta_0 - X_i^T\beta) = 0 \implies \beta_0 = \frac1n \underbrace{\sum_i Y_i}_{0} - \frac1n \sum_i X_i^T \beta = -  \underbrace{\frac1n(n_1\mu_1 + n_2\mu_2)'}_{\mu}\beta\)</li>
<li>With respect to \(\beta\):</li>
</ul>
\begin{align*}
0 &= \sum_i (Y_i - \beta_0 - X_i^T\beta) X_i
\\&= \sum_i (Y_i +  (\hat \mu - X_i)^T\beta)X_i
\\&\implies \sum_i Y_i X_i = \sum_i -X_i( \hat \mu - X_i)^T\beta
\\&\implies n(\hat \mu_2 - \hat \mu_1) = \left(- n \hat \mu \hat \mu^T + \sum_i X_i X_i^T\right)\beta
\\&\implies n(\hat \mu_2 - \hat \mu_1) = \underbrace{\left(- n \hat \mu \hat \mu^T + \sum_i X_i X_i^T\right)}_{\hat \Sigma}\beta
\end{align*}
<p>
So \(\hat \beta \equiv \hat w\)
</p>

<p>
3.3 An example where LDA fails but the data is linearly separable:
</p>

<div class="org">

<div class="figure">
<p><img src="img/faillda.png" alt="faillda.png" class="center" />
</p>
<p><span class="figure-number">Figure 5:</span> Fail LDA</p>
</div>

</div>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4"><span class="section-number-2">4</span> Q4</h2>
<div class="outline-text-2" id="text-4">
<p>
4.1. 
   Let \(y_1, \ldots, y_n\) be any labeling, and let \(w = \gamma (y_1, \ldots, y_n)\), then:
   \(y_i (w, e_i) = y_i^2 \gamma = \gamma\)
</p>

<p>
Let \(D_0 = \{e_1, \ldots, e_{\frac d2} \}\), \(D_1 = \{e_{\frac d2 + 1}, \ldots, e_d\}\)
Take \(s\) samples from \(D_0\) and \(s\) sample from \(D_1\)
</p>
<ul class="org-ul">
<li>Label all points in \(D_0\) by 1 except the one in the sample</li>
<li>Label all points in \(D_1\) by -1 except the one in the sample</li>
</ul>
<p>
   Take \(w\) to be the seperating vector. Then \(w\) classifies correctly the \(2s\) points in the sample but missclassifies the rest of the points \(d - 2s \ge \frac d3\)
4.2.
Let \(j\) be the first index for which \(x_j = 1\)
\(\sum_{i=1}^d \frac{(-1)^{i-1}}{2^{i-1}} x_i = \frac{(-1)^{j-1}}{2^{j-1}} ( 1 + \underbrace{\sum_{i=1}^{d-j} \frac{(-1)^{i}}{2^{i}} x_{i+j}}_{ <1})\)
So this quantity has the the same sign as \((-1)^{j-1}\), which is what we want.
</p>


<p>
Suppose we could have another linear seperator with \((a_1, \ldots, a_d)\) s.t \(\sum_i a_i^2 = 1\) with margin \(\frac1{f(d)}\), then
</p>

<p>
\(\sum_{i=1}^d a_i x_i =  a_j + \sum_{i=j+1}^{d} a_i x_i\)
</p>

<ul class="org-ul">
<li>For all \(x\) in the $d$-cube,  \(a_{2j} + \sum_{i=2j+1}^{d} a_i x_i \ge \frac1{f(d)} \implies |a_{2j}| \ge \sum_{i=2j+1}^{d} |a_i|  + \frac1{f(d)}\)</li>
<li>Using the same argument: \(|a_{2j-1}| \ge \sum_{i=2j}^{d} |a_i|  + \frac1{f(d)}\)
As a conclusion, \(|a_j| \ge \sum_{i=j+1}^{d} |a_i|  + \frac1{f(d)}\).
Consider the sequence \(u_j\) definied by:
\(u_d = a_d, u_j = \sum_{i=j+1}^d u_i + \frac{1}{f(d)}\)</li>
</ul>

<p>
By induction we can easily see that:
</p>
<ul class="org-ul">
<li>\(u_j \le |a_j|\) and</li>
<li>\(u_1  = 2^{d-1} u_d + (2^{d-1} -1)\frac1{f(d)} \ge (2^{d-1} -1)\frac1{f(d)}\)</li>
</ul>

<p>
Since \(|a_1| \le 1\):
  \(1 \ge a_1 \ge u_1 \ge (2^{n-1}-1)\frac{1}{f(d)}\)
  Therefore
  \(f(d) \ge 2^{d-1}-1\)
</p>

<p>
So \(f(d)\) cannot be bounded by a polynomial from above.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: <span class="timestamp-wrapper"><span class="timestamp">&lt;2016-03-11 Fri&gt;</span></span></p>
<p class="author">Author: Bachir El khadir</p>
<p class="date">Created: 2016-03-22 Tue 21:11</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
