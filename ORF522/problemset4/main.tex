\documentclass[12pt]{article}

% packages

\usepackage{geometry}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage[]{mcode}



% custom commands
\newcommand{\Q}[1]{\subsubsection*{Problem #1}}

% parameters
\geometry{hmargin=1cm,vmargin=1cm}
\title{ORF524 - Problem Set 4}
\author{Bachir EL KHADIR }

\begin{document}

\maketitle

\Q{1}
KKT conditions

\begin{itemize}
\item $\exists \lambda_j, \ge 0,  j= 1..n$ s.t $\nabla f(x^*) = - \sum_j \lambda_j \nabla g_j(x^*)$
\item $g_j(x^*) \le 0$ for $j = 1..n$
\end{itemize}


Let $x$ be a feasible solution to the second optimization problem. We have that

\begin{align*}
\nabla f(x^*)^T(x-x^*) &= - \sum_j \lambda_j \nabla g_j(x^*)^T(x-x^*)
\\& \ge - \sum_j g_j(x^*) &\text{by feasibility of $x$}
\\& \ge 0 
\end{align*}

As a result, $f(x^*) + f(x^*)^T(x^*-x^*) \le f(x^*) + f(x^*)^T(x-x^*)$, and since $x^*$ trivially verifies the feasibility conditions of the second problem, $x^*$ is a global optimal.


\Q{2}


\begin{enumerate}
\item First order conditions:
\[
0 = \nabla f = \left( 
\begin{array}{c} 
4x + y - 6\\
x + 2y + z - 7 \\
y + 2z - 8
\end{array}
\right)
\]

Or 

\[
\left( 
\begin{array}{ccc} 
4&1&0\\
1&2&1 \\
0&1&2
\end{array}
\right)
\left( 
\begin{array}{c} 
x\\y\\z
\end{array}
\right)
=
\left( 
\begin{array}{c} 
6\\7\\8
\end{array}
\right)
\]


Which can be resolved:
\[
X^* = 
\left( 
\begin{array}{c} 
x\\y\\z
\end{array}
\right)
=
\frac15
\left( 
\begin{array}{c} 
6\\6\\17
\end{array}
\right)
\]


\item 

\[
\nabla^2 f(x,y,z) = \left(
\begin{array}{ccc}
4 & 1 & 0 \\
1 & 2 & 1 \\
0 & 1 & 2
\end{array}
\right)
\]


\item 

\begin{align*}
f(x,y,z) &=  x^2 + \frac12 y^2 + (x+\frac12 y)^2 + (z+\frac12 y)^2- 6x -7y - 8z - 9
\\&= x^2 - 6x + \frac12 (y^2 - 6 y) + (x+\frac12 y)^2 + ( (z+\frac12 y)^2  - 8(z+\frac12y) )  - 9
\\&= (x-3)^2 + \frac12 (y-3)^2 + (x+\frac12 y)^2 + (z+\frac12y - 4)^2 - 9 - 9 - \frac12 9 - 16
\\&= (x-3)^2 + \frac12 (y-3)^2 + (x+\frac12 y)^2 + (z+\frac12y - 4)^2 - 38.5 \ge -38.5
\end{align*}
$f$ is a continous function bounded from below, and is coercive, it has a global minimum, which is also a local minimum. 
Since $f$ admits only one local minimum $X^*$, it is a global minimum, and $\min f = f(\frac{6}{5}, \frac65, \frac{17}5) = -30.4$

\item 

\lstinputlisting[language=Matlab, frame=single, breaklines=true]{problem2.m}

\end{enumerate}

\Q{3}

\begin{enumerate}

\item
Let's consider the problem (P):

$$\max_{2\pi(x^2 + y) \le C, x \ge 0, y \ge 0} \pi xy$$

The feasible set is bounded and closed. The objective function is continuous. So it has an optimal solution $(x^*, y^*)$. $x^* y^* \ne 0$ because $\frac{\sqrt C}2 \frac C 2 > 0$.

Let $h^* = \frac {x^*}{y^*}, r^* = x^*$. $(r^*, h^*)$ is optimal because:

\begin{itemize}
\item It is feasible: $2\pi({r^*}^2, + r^*h^*) = 2\pi({x^*}^2 + y^*) \le C$, $r > 0, h > 0$
\item If $r, h$ another feasible solution, then $x = r, y = rh$ is feasible for the problem (P), and therefore: $\pi x y \le \pi x^* y^*$, ie $\pi r^2h \le {r^{*}}^2h^*$
\end{itemize}

\item We can rewrite the problem into an equivalent problem by taking the $\log$ of the objective function (with the convention $\log(0) = -\infty$, which makes $\log$ increasing in $R^+$).

$$\max_{2\pi(r^2+rh) \le C} \log(\pi) + 2 \log(r) + \log(h)$$

And this is a convexe problem because:

\begin{itemize}
\item the objective function in concave as the sum of two concave functions
\item the constraint function $(r,h) \rightarrow r^2 + rh$ is convexe because its hessian \[\left(\begin{array}{cc}2&2r\\2r&2\end{array} \right) = 2 \left(\begin{array}{cc}1&r\\r&1\end{array} \right)\]
has positive derterminant (1), so the two eigen values are of the same sign, and their sum is positive (equal to the trace: 4)
\end{itemize}



\item

The lagrangian $\mathcal L(r, h, \lambda) = \pi r^2 h + \lambda (C - 2\pi r^2 - 2\pi r h)$

KKT (we know that $rh \ne 0$ from previous question):

\begin{itemize}
\item $0 = \frac{\partial}{ \partial r}\mathcal L = 2\pi (rh - \lambda (2r + h)) \Rightarrow \lambda = \frac{rh}{2r + h}$
\item $0 = \frac{\partial}{ \partial h}\mathcal L = \pi (r^2 - \lambda 2 r) \Rightarrow \lambda = \frac r 2 \ne 0$
\item $\lambda = \frac r 2 = \frac{rh}{2r + h} \Rightarrow h = 2r $

\item Complementary condition $\lambda \ne 0 \Rightarrow C = 2\pi (r^2 + rh) = 6\pi r^2 \Rightarrow r = \sqrt{\frac{C}{6\pi}}$
\end{itemize}

Conclusion: $r = \sqrt{\frac{C}{6\pi}}$, $h =  \sqrt{\frac{2C}{3\pi}}$.
\end{enumerate}




\Q{4}

\begin{enumerate}
\item $f = -\log$, $g = \exp$ are both convexe but $fog(x) = -x$ is concave

\item 
Let $\lambda \in [0, 1]$, since $g$ is convexe:
$g(\lambda x + (1-\lambda)y) \le \lambda g(x) + (1-\lambda)g(y)$

Since $f$ is non-decreasing:
$f(g(\lambda x + (1-\lambda)y)) \le f(\lambda g(x) + (1-\lambda)g(y))$

Since $f$ is convexe:
$f(\lambda g(x) + (1-\lambda)g(y)) \le \lambda fog(x) + (1-\lambda)fog(y)$


as a conclusion 
$$fog(\lambda x + (1-\lambda)y) \le \lambda fog(x) + (1-\lambda)fog(y)$$

and $fog$ is convexe

\item

if $f$ concave and non-increasing, $-f$ is convexe and non-decreasing, therefore $-fog$ is convexe, and $fog$ is concave.

\item

Let's take $f = 1 - e^{-x}$. 
$f$ is increasing and non negative. $f' = e^{-x}$, $f'' = -f'$


$(xf)'' = xf'' + f' = e^{-x}(1-x) < 0$ when $x > 1$, so $xf$ is not convexe on $R^+$.
 



\end{enumerate}
\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:

